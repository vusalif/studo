<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A focused study timer with session tracking and progress visualization">
    <meta name="theme-color" content="#0f0f0f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Studo">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTIgMkM2LjQ4IDIgMiA2LjQ4IDIgMTJzNC40OCAxMCAxMCAxMCAxMC00LjQ4IDEwLTEwUzE3LjUyIDIgMTIgMnptMCAxOGMtNC40MSAwLTgtMy41OS04LTggczMuNTktOCA4LTggOCAzLjU5IDggOC0zLjU5IDgtOCA4eiIgZmlsbD0iI2ZmZmZmZiIvPgo8cGF0aCBkPSJNMTIgNkM5Ljc5IDYgOCA3Ljc5IDggMTBzMS43OSA0IDQgNCA0LTEuNzkgNC00LTEuNzktNC00LTR6bTAgNmMtMS4xIDAtMi0uOS0yLTIgcy45LTIgMi0yIDIgLjkgMiAyLS45IDItMiAyeiIgZmlsbD0iI2ZmZmZmZiIvPgo8L3N2Zz4K">
    <title>Studo - Study Timer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Kirang+Haerang&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">

        
        <div class="timer-controls">
            <button id="logBtn" class="control-btn" title="Documents (M)">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <g fill="none">
                        <path d="M24 0v24H0V0h24ZM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427c-.002-.01-.009-.017-.017-.018Zm.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093c.012.004.023 0 .029-.008l.004-.014l-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014l-.034.614c0 .012.007.02.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01l-.184-.092Z"/>
                        <path fill="white" d="M6 2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h11a3 3 0 0 0 3-3V5a3 3 0 0 0-3-3h-1v9.793a.5.5 0 0 1-.854.353l-1.792-1.792a.5.5 0 0 0-.708 0l-1.792 1.792a.5.5 0 0 1-.854-.353V2H6Z"/>
                    </g>
                </svg>
            </button>
            <button id="playBtn" class="control-btn" title="Start Timer (Enter/S)">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 5V19L19 12L8 5Z" fill="white"/>
                </svg>
            </button>
            <div id="timer" class="timer" title="Click to switch modes">25:00</div>
            <button id="pauseBtn" class="control-btn" title="Pause/Resume (P)">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 4H10V20H6V4ZM14 4H18V20H14V4Z" fill="white"/>
                </svg>
            </button>

            <button id="settingsBtn" class="control-btn" title="Settings (Q)">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 48 48">
                    <path fill="white" d="M19.494 43.468c1.479.353 2.993.531 4.513.531a19.425 19.425 0 0 0 4.503-.534a1.94 1.94 0 0 0 1.474-1.672l.338-3.071a2.318 2.318 0 0 1 2.183-2.075c.367-.016.732.053 1.068.2l2.807 1.231a1.922 1.922 0 0 0 1.554.01c.247-.105.468-.261.65-.458a20.372 20.372 0 0 0 4.51-7.779a1.942 1.942 0 0 0-.7-2.133l-2.494-1.84a2.326 2.326 0 0 1 0-3.764l2.486-1.836a1.943 1.943 0 0 0 .7-2.138a20.325 20.325 0 0 0-4.515-7.777a1.936 1.936 0 0 0-2.192-.45l-2.806 1.236c-.29.131-.606.2-.926.2a2.338 2.338 0 0 1-2.32-2.088l-.34-3.06a1.937 1.937 0 0 0-1.5-1.681a21.663 21.663 0 0 0-4.469-.519a21.922 21.922 0 0 0-4.5.52a1.935 1.935 0 0 0-1.5 1.677l-.34 3.062a2.345 2.345 0 0 1-.768 1.488a2.526 2.526 0 0 1-1.569.6a2.3 2.3 0 0 1-.923-.194l-2.8-1.236a1.937 1.937 0 0 0-2.2.452a20.354 20.354 0 0 0-4.51 7.775a1.941 1.941 0 0 0 .7 2.137l2.488 1.836a2.344 2.344 0 0 1 .701 2.938a2.338 2.338 0 0 1-.7.829l-2.49 1.839a1.94 1.94 0 0 0-.7 2.135a20.333 20.333 0 0 0 4.51 7.782a1.929 1.929 0 0 0 2.193.454l2.818-1.237c.291-.128.605-.194.923-.194h.008a2.338 2.338 0 0 1 2.32 2.074l.338 3.057a1.94 1.94 0 0 0 1.477 1.673ZM24 30.25a6.25 6.25 0 1 1 0-12.5a6.25 6.25 0 0 1 0 12.5Z"/>
                </svg>
            </button>
        </div>
        <div class="progress-bar"></div>
        

        
        <div id="heatmap" class="heatmap-container">
            <p style="color: #666; font-size: 14px; font-family: 'IBM Plex Mono', monospace;">Study sessions will be tracked here</p>
        </div>
        
        <div id="logContainer" class="log-container" style="display: none;">
            <div class="log-header">
                <h3 style="margin: 0; font-family: 'IBM Plex Mono', monospace; color: white;">Study Session Log</h3>
                <div class="log-filters">
                    <select id="logTimeFilter" style="font-family: 'IBM Plex Mono', monospace; padding: 6px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; font-size: 12px;">
                        <option value="all">All Time</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                        <option value="year">This Year</option>
                    </select>
                    <select id="logSortBy" style="font-family: 'IBM Plex Mono', monospace; padding: 6px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; font-size: 12px;">
                        <option value="date-desc">Newest First</option>
                        <option value="date-asc">Oldest First</option>
                        <option value="duration-desc">Longest First</option>
                        <option value="duration-asc">Shortest First</option>
                    </select>
                </div>
            </div>
            <div id="logContent" class="log-content">
                <!-- Log entries will be populated here -->
            </div>
        </div>
        

    </div>
    
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 style="margin: 0; font-family: 'IBM Plex Mono', monospace; color: white;">Settings</h3>
                <button id="closeSettings" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="timerMode" style="font-family: 'IBM Plex Mono', monospace; color: white; display: block; margin-bottom: 10px;">Timer Mode:</label>
                    <select id="timerMode" style="font-family: 'IBM Plex Mono', monospace; padding: 8px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; width: 100%;">
                        <option value="timer">Focus Timer</option>
                        <option value="stopwatch">Stopwatch</option>
                    </select>
                </div>
                
                <div class="setting-group" id="focusTimeGroup">
                    <label for="focusMinutes" style="font-family: 'IBM Plex Mono', monospace; color: white; display: block; margin-bottom: 10px;">Focus Timer Duration:</label>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <div style="flex: 1;">
                            <label for="focusMinutes" style="font-family: 'IBM Plex Mono', monospace; color: #ccc; font-size: 12px; display: block; margin-bottom: 5px;">Minutes:</label>
                            <input type="number" id="focusMinutes" min="0" max="1440" value="25" style="font-family: 'IBM Plex Mono', monospace; padding: 8px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; width: 100%;">
                        </div>
                        <div style="flex: 1;">
                            <label for="focusSeconds" style="font-family: 'IBM Plex Mono', monospace; color: #ccc; font-size: 12px; display: block; margin-bottom: 5px;">Seconds:</label>
                            <input type="number" id="focusSeconds" min="0" max="59" value="0" style="font-family: 'IBM Plex Mono', monospace; padding: 8px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; width: 100%;">
                        </div>
                    </div>
                </div>
                
                <div class="setting-group">
                    <button id="saveSettings" style="font-family: 'IBM Plex Mono', monospace; padding: 10px 20px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%; margin-top: 20px;">Save Settings</button>
                </div>
                
                <div class="setting-group" id="installAppGroup" style="display: none;">
                    <label style="font-family: 'IBM Plex Mono', monospace; color: white; display: block; margin-bottom: 10px;">Install App:</label>
                    <button id="installAppBtn" style="font-family: 'IBM Plex Mono', monospace; padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%;">
                        📱 Install Studo App
                    </button>
                    <p style="font-family: 'IBM Plex Mono', monospace; color: #ccc; font-size: 12px; margin-top: 8px; text-align: center;">
                        Install for offline use and quick access
                    </p>
                    <p id="localhostNotice" style="font-family: 'IBM Plex Mono', monospace; color: #ff6b6b; font-size: 11px; margin-top: 8px; text-align: center; display: none;">
                        ⚠️ PWA features disabled on localhost
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Session Modal -->
    <div id="editSessionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 style="margin: 0; font-family: 'IBM Plex Mono', monospace; color: white;">Edit Study Session</h3>
                <button id="closeEditSession" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-group">
                    <label for="editSessionDate" style="font-family: 'IBM Plex Mono', monospace; color: white; display: block; margin-bottom: 10px;">Date:</label>
                    <input type="date" id="editSessionDate" style="font-family: 'IBM Plex Mono', monospace; padding: 8px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; width: 100%;">
                </div>
                

                
                <div class="setting-group">
                    <label for="editSessionDescription" style="font-family: 'IBM Plex Mono', monospace; color: white; display: block; margin-bottom: 10px;">Description:</label>
                    <textarea id="editSessionDescription" placeholder="What did you study?" rows="3" style="font-family: 'IBM Plex Mono', monospace; padding: 8px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; width: 100%; resize: vertical;"></textarea>
                </div>
                
                <div class="setting-group">
                    <label for="editSessionImage" style="font-family: 'IBM Plex Mono', monospace; color: white; display: block; margin-bottom: 10px;">Image URL (optional):</label>
                    <input type="url" id="editSessionImage" placeholder="https://example.com/image.jpg" style="font-family: 'IBM Plex Mono', monospace; padding: 8px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; width: 100%;">
                </div>
                
                <div class="setting-group">
                    <label for="editSessionNotes" style="font-family: 'IBM Plex Mono', monospace; color: white; display: block; margin-bottom: 10px;">Notes:</label>
                    <textarea id="editSessionNotes" placeholder="Additional notes, formulas, key points..." rows="4" style="font-family: 'IBM Plex Mono', monospace; padding: 8px; border-radius: 4px; border: 1px solid #666; background: #333; color: white; width: 100%; resize: vertical;"></textarea>
                </div>
                
                <div class="setting-group">
                    <button id="saveEditSession" style="font-family: 'IBM Plex Mono', monospace; padding: 10px 20px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%; margin-top: 20px;">Save Changes</button>
                </div>
            </div>
        </div>
    </div>
    

    

    
    <script src="script.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Check if we're on localhost
        const isLocalhost = window.location.hostname === 'localhost' || 
                           window.location.hostname === '127.0.0.1' || 
                           window.location.hostname === '0.0.0.0';
        
        console.log('🌐 Current location:', window.location.href);
        console.log('🔧 Protocol:', window.location.protocol);
        console.log('🏠 Hostname:', window.location.hostname);
        console.log('📁 Pathname:', window.location.pathname);
        console.log('🏠 Is localhost:', isLocalhost);
        
        // Only register service worker if not on localhost (to avoid conflicts)
        if ('serviceWorker' in navigator && !isLocalhost) {
            window.addEventListener('load', () => {
                // Try to unregister any existing service workers first
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        registration.unregister();
                        console.log('Unregistered existing SW:', registration);
                    }
                    
                    // Now register the new one
                    return navigator.serviceWorker.register('./sw.js');
                }).then((registration) => {
                    console.log('✅ Service Worker registered successfully:', registration);
                }).catch((registrationError) => {
                    console.log('❌ Service Worker registration failed:', registrationError);
                });
            });
        } else if (isLocalhost) {
            console.log('🚫 Service Worker disabled on localhost to avoid conflicts');
            console.log('💡 Use file:// protocol or deploy to a real server for PWA features');
        } else {
            console.log('❌ Service Worker not supported in this browser');
        }
        
        // Check if app is installed
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('📱 Install prompt ready');
        });
        
        // Handle app installation
        window.addEventListener('appinstalled', () => {
            console.log('✅ PWA was installed');
            deferredPrompt = null;
        });
    </script>
</body>
</html>
