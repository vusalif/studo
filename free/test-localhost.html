<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Studo - Localhost Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0f0f0f;
            color: white;
            padding: 20px;
            margin: 0;
        }
        .test-section {
            background: #333;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .test-button {
            background: #666;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #888;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #4CAF50; }
        .error { background: #f44336; }
        .info { background: #2196F3; }
        .warning { background: #ff9800; }
    </style>
</head>
<body>
    <h1>üß™ Studo - Localhost Test Page</h1>
    
    <div class="test-section">
        <h2>üåê Environment Check</h2>
        <div id="envInfo"></div>
        <button class="test-button" onclick="checkEnvironment()">Check Environment</button>
    </div>
    
    <div class="test-section">
        <h2>‚è±Ô∏è Timer Functionality Test</h2>
        <div id="timerTest"></div>
        <button class="test-button" onclick="testTimer()">Test Timer</button>
        <button class="test-button" onclick="testPauseResume()">Test Pause/Resume</button>
        <button class="test-button" onclick="testModeSwitch()">Test Mode Switch</button>
    </div>
    
    <div class="test-section">
        <h2>üîß Service Worker Test</h2>
        <div id="swTest"></div>
        <button class="test-button" onclick="testServiceWorker()">Test Service Worker</button>
        <button class="test-button" onclick="unregisterSW()">Unregister SW</button>
    </div>
    
    <div class="test-section">
        <h2>üì± PWA Test</h2>
        <div id="pwaTest"></div>
        <button class="test-button" onclick="testPWA()">Test PWA</button>
    </div>
    
    <div class="test-section">
        <h2>üíæ Local Storage Test</h2>
        <div id="storageTest"></div>
        <button class="test-button" onclick="testLocalStorage()">Test Local Storage</button>
        <button class="test-button" onclick="clearLocalStorage()">Clear Local Storage</button>
    </div>
    
    <div class="test-section">
        <h2>üöÄ Go to Main App</h2>
        <a href="index.html" class="test-button" style="text-decoration: none; display: inline-block;">Open Studo App</a>
    </div>

    <script>
        // Environment check
        function checkEnvironment() {
            const envInfo = document.getElementById('envInfo');
            const isLocalhost = window.location.hostname === 'localhost' || 
                               window.location.hostname === '127.0.0.1' || 
                               window.location.hostname === '0.0.0.0';
            
            envInfo.innerHTML = `
                <div class="status ${isLocalhost ? 'warning' : 'success'}">
                    <strong>Hostname:</strong> ${window.location.hostname}<br>
                    <strong>Protocol:</strong> ${window.location.protocol}<br>
                    <strong>Port:</strong> ${window.location.port || 'default'}<br>
                    <strong>Environment:</strong> ${isLocalhost ? 'localhost' : 'production'}<br>
                    <strong>User Agent:</strong> ${navigator.userAgent.substring(0, 100)}...
                </div>
            `;
        }
        
        // Timer functionality test
        function testTimer() {
            const timerTest = document.getElementById('timerTest');
            try {
                // Test basic timer logic
                let timeLeft = 25 * 60;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                timerTest.innerHTML = `
                    <div class="status success">
                        ‚úÖ Timer logic working: ${display}<br>
                        ‚úÖ Math operations working<br>
                        ‚úÖ String formatting working
                    </div>
                `;
            } catch (error) {
                timerTest.innerHTML = `
                    <div class="status error">
                        ‚ùå Timer test failed: ${error.message}
                    </div>
                `;
            }
        }
        
        // Pause/Resume test
        function testPauseResume() {
            const timerTest = document.getElementById('timerTest');
            try {
                // Simulate timer states
                let isRunning = true;
                let isPaused = false;
                
                // Test pause
                isRunning = false;
                isPaused = true;
                
                // Test resume
                isRunning = true;
                isPaused = false;
                
                timerTest.innerHTML = `
                    <div class="status success">
                        ‚úÖ Pause/Resume state logic working<br>
                        ‚úÖ State transitions working<br>
                        ‚úÖ Boolean operations working
                    </div>
                `;
            } catch (error) {
                timerTest.innerHTML = `
                    <div class="status error">
                        ‚ùå Pause/Resume test failed: ${error.message}
                    </div>
                `;
            }
        }
        
        // Mode switch test
        function testModeSwitch() {
            const timerTest = document.getElementById('timerTest');
            try {
                let timerMode = 'timer';
                let timeLeft = 25 * 60;
                
                // Test mode switch
                if (timerMode === 'timer') {
                    timerMode = 'stopwatch';
                    timeLeft = 0;
                } else {
                    timerMode = 'timer';
                    timeLeft = 25 * 60;
                }
                
                timerTest.innerHTML = `
                    <div class="status success">
                        ‚úÖ Mode switching logic working<br>
                        ‚úÖ Timer mode: ${timerMode}<br>
                        ‚úÖ Time left: ${timeLeft} seconds
                    </div>
                `;
            } catch (error) {
                timerTest.innerHTML = `
                    <div class="status error">
                        ‚ùå Mode switch test failed: ${error.message}
                    </div>
                `;
            }
        }
        
        // Service Worker test
        function testServiceWorker() {
            const swTest = document.getElementById('swTest');
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    if (registrations.length > 0) {
                        swTest.innerHTML = `
                            <div class="status warning">
                                ‚ö†Ô∏è Found ${registrations.length} service worker(s)<br>
                                This might cause conflicts on localhost
                            </div>
                        `;
                    } else {
                        swTest.innerHTML = `
                            <div class="status success">
                                ‚úÖ No service workers found<br>
                                This is good for localhost testing
                            </div>
                        `;
                    }
                });
            } else {
                swTest.innerHTML = `
                    <div class="status error">
                        ‚ùå Service Worker not supported in this browser
                    </div>
                `;
            }
        }
        
        // Unregister service workers
        function unregisterSW() {
            const swTest = document.getElementById('swTest');
            
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    registrations.forEach(registration => {
                        registration.unregister();
                    });
                    swTest.innerHTML = `
                        <div class="status success">
                            ‚úÖ All service workers unregistered<br>
                            Refresh the page to see changes
                        </div>
                    `;
                });
            }
        }
        
        // PWA test
        function testPWA() {
            const pwaTest = document.getElementById('pwaTest');
            
            if ('serviceWorker' in navigator) {
                pwaTest.innerHTML = `
                    <div class="status info">
                        ‚ÑπÔ∏è Service Worker API available<br>
                        ‚ÑπÔ∏è PWA features supported
                    </div>
                `;
            } else {
                pwaTest.innerHTML = `
                    <div class="status error">
                        ‚ùå Service Worker API not available<br>
                        ‚ùå PWA features not supported
                    </div>
                `;
            }
        }
        
        // Local Storage test
        function testLocalStorage() {
            const storageTest = document.getElementById('storageTest');
            
            try {
                // Test write
                localStorage.setItem('test', 'Hello World');
                
                // Test read
                const value = localStorage.getItem('test');
                
                // Test delete
                localStorage.removeItem('test');
                
                storageTest.innerHTML = `
                    <div class="status success">
                        ‚úÖ Local Storage working<br>
                        ‚úÖ Write/Read/Delete operations successful<br>
                        ‚úÖ Test value: ${value}
                    </div>
                `;
            } catch (error) {
                storageTest.innerHTML = `
                    <div class="status error">
                        ‚ùå Local Storage test failed: ${error.message}
                    </div>
                `;
            }
        }
        
        // Clear local storage
        function clearLocalStorage() {
            const storageTest = document.getElementById('storageTest');
            
            try {
                localStorage.clear();
                storageTest.innerHTML = `
                    <div class="status warning">
                        ‚ö†Ô∏è Local Storage cleared<br>
                        All app data has been removed
                    </div>
                `;
            } catch (error) {
                storageTest.innerHTML = `
                    <div class="status error">
                        ‚ùå Failed to clear Local Storage: ${error.message}
                    </div>
                `;
            }
        }
        
        // Auto-run environment check on page load
        window.addEventListener('load', () => {
            checkEnvironment();
            testServiceWorker();
            testPWA();
            testLocalStorage();
        });
    </script>
</body>
</html>
